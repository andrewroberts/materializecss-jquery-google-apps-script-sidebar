
<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>
  
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

<script>

  $(document).ready(function() {  
    $('#test-form').submit(onSidebarFormSubmit)
  })

  function onSidebarFormSubmit(event) {
  
    event.preventDefault()
 
    var status = $('#submit-status')
    var button = $('#submit-button')
    var form = $('#test-form')
  
    status.hide()
    button.text('Submitting...')
    button.addClass('disabled')

    google.script.run
      .withSuccessHandler(function() {        
        form.hide()
        status.removeClass('error')
        status.text('Form submitted OK!')
        status.show()
      })
      .withFailureHandler(function(error) {
        status.addClass('error')
        status.text(error)
        status.show()
        button.text('Submit')
        button.removeClass('disabled')
      })
      .onFormSubmit(form.get()[0]);  
  }

</script>